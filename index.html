// This is the updated function
function processSpanishSentence(card) {
    let sentence = card.spanish;
    if (!card.verbs || card.verbs.length === 0) {
        return sentence;
    }

    // A pattern to match the verb and any leading/trailing spaces
    const pattern = new RegExp(`(\\s*)\\b(${card.verbs.map(v => v.word).join('|')})\\b(\\s*)`, 'gi');

    return sentence.replace(pattern, (match, p1, p2, p3) => {
        // p1 and p3 are the leading and trailing spaces, p2 is the verb itself.
        // We'll keep the original spacing but wrap the verb in the span.
        const verbInfo = card.verbs.find(v => v.word.toLowerCase() === p2.toLowerCase());

        return `${p1}<span class="verb">${p2}<span class="tooltip"><span class="tooltip-content"><strong>Infinitive:</strong> ${verbInfo.infinitive} (${verbInfo.meaning})<br><strong>Conjugation:</strong> ${verbInfo.conjugation}</span></span></span>${p3}`;
    }).trim();
}
